@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  /* ── Palette (static, always available) ── */
  --color-navy:      #30364F;
  --color-steel:     #ACBAC4;
  --color-cream:     #E1D9BC;
  --color-parchment: #F0F0DB;

  /* ── Semantic (switches with .dark class) ── */
  --color-background:         var(--background);
  --color-foreground:         var(--foreground);
  --color-card:               var(--card);
  --color-card-foreground:    var(--card-foreground);
  --color-popover:            var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary:            var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary:          var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted:              var(--muted);
  --color-muted-foreground:   var(--muted-foreground);
  --color-accent:             var(--accent);
  --color-accent-foreground:  var(--accent-foreground);
  --color-destructive:        var(--destructive);
  --color-border:             var(--border);
  --color-input:              var(--input);
  --color-ring:               var(--ring);

  /* ── App-specific semantic tokens ── */
  --color-panel:              var(--panel);
  --color-elevated:           var(--elevated);
  --color-bubble-sent:        var(--bubble-sent);
  --color-bubble-recv:        var(--bubble-recv);
  --color-bubble-sent-text:   var(--bubble-sent-text);
  --color-bubble-recv-text:   var(--bubble-recv-text);
  --color-skeleton:           var(--skeleton);
  --color-online-dot:         var(--online-dot);

  /* ── Sidebar compat ── */
  --color-sidebar:                    var(--panel);
  --color-sidebar-foreground:         var(--foreground);
  --color-sidebar-primary:            var(--primary);
  --color-sidebar-primary-foreground: var(--primary-foreground);
  --color-sidebar-accent:             var(--elevated);
  --color-sidebar-accent-foreground:  var(--foreground);
  --color-sidebar-border:             var(--border);
  --color-sidebar-ring:               var(--ring);

  /* ── Typography ── */
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);

  /* ── Radius ── */
  --radius-sm:  calc(var(--radius) - 4px);
  --radius-md:  calc(var(--radius) - 2px);
  --radius-lg:  var(--radius);
  --radius-xl:  calc(var(--radius) + 4px);
  --radius-2xl: calc(var(--radius) + 8px);
  --radius-3xl: calc(var(--radius) + 16px);
}

/* ══════════════════════════════════════════ */
/*   LIGHT MODE                               */
/* ══════════════════════════════════════════ */
:root {
  --radius: 0.75rem;

  --background:           #F0F0DB;
  --foreground:           #30364F;
  --card:                 #FFFFFF;
  --card-foreground:      #30364F;
  --popover:              #FFFFFF;
  --popover-foreground:   #30364F;
  --primary:              #30364F;
  --primary-foreground:   #F0F0DB;
  --secondary:            #E1D9BC;
  --secondary-foreground: #30364F;
  --muted:                #E8E5CF;
  --muted-foreground:     #6b778a;
  --accent:               #E1D9BC;
  --accent-foreground:    #30364F;
  --destructive:          #c0392b;
  --border:               rgba(48, 54, 79, 0.13);
  --input:                rgba(48, 54, 79, 0.07);
  --ring:                 #30364F;

  --panel:                #E4E0C8;
  --elevated:             #FFFFFF;
  --bubble-sent:          #30364F;
  --bubble-recv:          #E1D9BC;
  --bubble-sent-text:     #F0F0DB;
  --bubble-recv-text:     #30364F;
  --skeleton:             rgba(48, 54, 79, 0.07);
  --online-dot:           #22c55e;
}

/* ══════════════════════════════════════════ */
/*   DARK MODE                                */
/* ══════════════════════════════════════════ */
.dark {
  --background:           #090d18;
  --foreground:           #F0F0DB;
  --card:                 #30364F;
  --card-foreground:      #F0F0DB;
  --popover:              #1b2136;
  --popover-foreground:   #F0F0DB;
  --primary:              #E1D9BC;
  --primary-foreground:   #30364F;
  --secondary:            #1b2136;
  --secondary-foreground: #F0F0DB;
  --muted:                #141929;
  --muted-foreground:     #ACBAC4;
  --accent:               #E1D9BC;
  --accent-foreground:    #30364F;
  --destructive:          #e74c3c;
  --border:               rgba(172, 186, 196, 0.10);
  --input:                rgba(172, 186, 196, 0.07);
  --ring:                 #E1D9BC;

  --panel:                #141929;
  --elevated:             #1b2136;
  --bubble-sent:          #3d4a6e;
  --bubble-recv:          #1b2136;
  --bubble-sent-text:     #F0F0DB;
  --bubble-recv-text:     #ACBAC4;
  --skeleton:             rgba(172, 186, 196, 0.07);
  --online-dot:           #22c55e;
}

/* ══════════════════════════════════════════ */
/*   BASE LAYER                               */
/* ══════════════════════════════════════════ */
@layer base {
  * {
    @apply border-border outline-ring/50;
    box-sizing: border-box;
  }
  html {
    scroll-behavior: smooth;
    height: 100%;
  }
  body {
    @apply bg-background text-foreground antialiased;
    height: 100%;
    font-feature-settings: "ss01", "cv11";
  }
  ::selection {
    background: rgba(48, 54, 79, 0.18);
    color: #30364F;
  }
  .dark ::selection {
    background: rgba(225, 217, 188, 0.18);
    color: #F0F0DB;
  }
}

/* ══════════════════════════════════════════ */
/*   UTILITY CLASSES                          */
/* ══════════════════════════════════════════ */
@layer utilities {
  /* Frosted glass */
  .glass {
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    background: rgba(240, 240, 219, 0.72);
  }
  .dark .glass {
    background: rgba(20, 25, 41, 0.80);
  }

  /* Subtle noise texture overlay (pseudo-element based) */
  .surface-noise::before {
    content: "";
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events: none;
    border-radius: inherit;
    z-index: 0;
  }

  /* Chat gradient brand */
  .gradient-navy {
    background: linear-gradient(135deg, #30364F 0%, #4a5278 100%);
  }

  /* Shimmer skeleton */
  .skeleton-shimmer {
    background: linear-gradient(
      90deg,
      var(--skeleton) 25%,
      rgba(172, 186, 196, 0.13) 50%,
      var(--skeleton) 75%
    );
    background-size: 200% 100%;
    animation: shimmer 1.8s ease-in-out infinite;
  }

  /* Focus ring */
  .focus-brand:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 2px;
  }
}

/* ══════════════════════════════════════════ */
/*   KEYFRAME ANIMATIONS                      */
/* ══════════════════════════════════════════ */
@keyframes shimmer {
  0%   { background-position:  200% 0; }
  100% { background-position: -200% 0; }
}

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(10px); }
  to   { opacity: 1; transform: translateY(0);     }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.94); }
  to   { opacity: 1; transform: scale(1);    }
}

@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-20px); }
  to   { opacity: 1; transform: translateX(0);     }
}

@keyframes slideInRight {
  from { opacity: 0; transform: translateX(20px); }
  to   { opacity: 1; transform: translateX(0);    }
}

@keyframes pulse-soft {
  0%, 100% { opacity: 1;   }
  50%       { opacity: 0.5; }
}

.animate-fade-up     { animation: fadeUp      0.3s ease forwards; }
.animate-fade-in     { animation: fadeIn      0.25s ease forwards; }
.animate-scale-in    { animation: scaleIn     0.2s ease forwards; }
.animate-slide-left  { animation: slideInLeft 0.3s ease forwards; }
.animate-slide-right { animation: slideInRight 0.3s ease forwards; }

/* Message bubble enter animation */
.msg-sent  { animation: slideInRight 0.22s ease forwards; }
.msg-recv  { animation: slideInLeft  0.22s ease forwards; }

/* ══════════════════════════════════════════ */
/*   CUSTOM SCROLLBAR                         */
/* ══════════════════════════════════════════ */
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb {
  background: rgba(172, 186, 196, 0.30);
  border-radius: 99px;
}
::-webkit-scrollbar-thumb:hover {
  background: rgba(172, 186, 196, 0.55);
}